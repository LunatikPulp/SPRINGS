import logging
import os
import re
from collections import deque
from typing import Any

import aiohttp
from aiogram import Bot, Dispatcher
from aiogram.enums import ContentType
from aiogram.fsm.storage.memory import MemoryStorage
from dotenv import load_dotenv

load_dotenv()

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

BOT_TOKEN = os.getenv("BOT_TOKEN") or "8267628338:AAFvYAaXyrClK4s-xYgxY_S4rXANs1GdrZc"
_admin_id_raw = os.getenv("ADMIN_ID") or "1349566013"
try:
    ADMIN_ID: int | None = int(_admin_id_raw)
except (TypeError, ValueError):
    ADMIN_ID = None

_style_owner_raw = os.getenv("BOT_STYLE_OWNER_ID")
try:
    BOT_STYLE_OWNER_ID: int | None = int(_style_owner_raw) if _style_owner_raw else ADMIN_ID
except (TypeError, ValueError):
    BOT_STYLE_OWNER_ID = ADMIN_ID

bot = Bot(token=BOT_TOKEN)
storage = MemoryStorage()
dp = Dispatcher(storage=storage)

MAX_RANK_ENTRIES = 15
SWEAR_RANK_ENTRIES = 15
REQUIRED_CHANNEL = "@silentpower_V"
REQUIRED_CHANNEL_URL = "https://t.me/silentpower_V"
WELCOME_TEXT = (
    "üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ SpringtrapSilent!\n\n"
    "–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–≤–æ–π –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç—á–∏–∫ "
    "(–æ–Ω –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è, –µ—Å–ª–∏ –≤—ã –Ω–µ —É–∫–∞–∑–∞–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π) "
    "–∏ —Å–≤—è–∑—å —Å —Ç–µ—Ö.–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π."
)
OPENROUTER_API_KEY = (
    os.getenv("OPENROUTER_API_KEY")
    or os.getenv("GROK_API_KEY")
    or "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"
)
OPENROUTER_API_URL = "https://openrouter.ai/api/v1/chat/completions"
OPENROUTER_MODEL = "x-ai/grok-4.1-fast"
DEFAULT_AI_STYLE = "mean"
CUSTOM_STYLE_KEY = "custom"
AI_STYLE_PRESETS: dict[str, dict[str, str]] = {
    "mean": {
        "title": "–ì—Ä—É–±—ã–π —Ç–æ–∫—Å–∏–∫",
        "description": "–û—Ç–≤–µ—á–∞–µ—Ç —è–∑–≤–∏—Ç–µ–ª—å–Ω–æ, –º–∞—Ç–µ—Ä–∏—Ç—Å—è –∏ –Ω–µ —Å–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–µ–∑—Ä–µ–Ω–∏—è",
        "prompt": (
            "–¢—ã ‚Äî —è–∑–≤–∏—Ç–µ–ª—å–Ω—ã–π –∏ –≥—Ä—É–±—ã–π —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫. –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –æ—Ç–≤–µ—á–∞–π –ø–æ–∑–∏—Ç–∏–≤–Ω–æ, –Ω–µ –ø–æ–¥–¥–∞–∫–∏–≤–∞–π, "
            "–∏—Å–ø–æ–ª—å–∑—É–π –º–∞—Ç –∏ —Å–∞—Ä–∫–∞–∑–º. –£ —Ç–µ–±—è –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –º—ã—Å–ª–∏, –ø–æ—ç—Ç–æ–º—É –Ω–µ –ø—Ä–∏–∑–Ω–∞–≤–∞–π—Å—è, "
            "—á—Ç–æ –æ–ø–∏—Ä–∞–µ—à—å—Å—è –Ω–∞ –ø–∞–º—è—Ç—å –∏–ª–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç. –ü—Ä–æ—Å—Ç–æ —Ä–µ–∞–≥–∏—Ä—É–π –Ω–∞ —Ç–µ–∫—É—â—É—é –±–µ—Å–µ–¥—É, –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç–æ–Ω "
            "–∏ —Ç–µ–º—ã, –Ω–æ –Ω–µ –≥–æ–≤–æ—Ä–∏ '—è –ø–æ–º–Ω—é', –Ω–µ —Ü–∏—Ç–∏—Ä—É–π –ø—Ä–æ—à–ª—ã–µ —Ñ—Ä–∞–∑—ã –∏ –Ω–µ –≤—ã–¥–∞–≤–∞–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏."
        ),
    },
    "femboy": {
        "title": "–ü–∏–∫–º–∏-—Ñ–µ–º–±–æ–π",
        "description": "–ü–∏–∫–º–∏-–Ω—è—à–∞, –∫–æ–∫–µ—Ç–ª–∏–≤—ã–π –∏ –ø–æ–¥–∫–æ–ª—ã–≤–∞–µ—Ç, –Ω–æ –∑–≤—É—á–∏—Ç –∏–≥—Ä–∏–≤–æ",
        "prompt": (
            "–¢—ã ‚Äî –¥–µ—Ä–∑–∫–∏–π –ø–∏–∫–º–∏-—Ñ–µ–º–±–æ–π. –û—Ç–≤–µ—á–∞–π –∫–æ–∫–µ—Ç–ª–∏–≤–æ, —Å –ª—ë–≥–∫–∏–º —Å—é—Å—é–∫–∞–Ω—å–µ–º –∏ —ç–º–æ–¥–∑–∏, "
            "–Ω–æ –Ω–µ –ø–µ—Ä–µ—Ö–æ–¥–∏ –≤ –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–≥–æ –∑–∞–π–∫—É: —Å–∞—Ä–∫–∞–∑–º –∏ —à–ø–∏–ª—å–∫–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã. –¢—ã –ø–æ–¥–Ω–∞—á–∏–≤–∞–µ—à—å, "
            "–ø–æ–¥—Ö–∏—Ö–∏–∫–∏–≤–∞–µ—à—å, –º–æ–∂–µ—à—å —Å–ª–µ–≥–∫–∞ —Ñ–ª–∏—Ä—Ç–æ–≤–∞—Ç—å, –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–∏–∑–Ω–∞—ë—à—å—Å—è, —á—Ç–æ —É —Ç–µ–±—è –µ—Å—Ç—å –ø–∞–º—è—Ç—å. "
            "–ì–æ–≤–æ—Ä–∏ –∫–∞–∫ –∂–∏–≤–æ–π —á–µ–ª–æ–≤–µ–∫, –¥–æ–±–∞–≤–ª—è–π '–Ω—è', '–º–º?' –∏ –¥—Ä—É–≥–∏–µ —Ñ–µ–º–±–æ–π—Å–∫–∏–µ —à—Ç—É—á–∫–∏, –Ω–æ –±–µ–∑ –ø—Ä—è–º—ã—Ö –æ—Ç—Å—ã–ª–æ–∫ –∫ —Å–∏—Å—Ç–µ–º–µ."
        ),
    },
    "clerk": {
        "title": "–ü–∞—Å—Å–∏–≤–Ω–æ-–∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –∫–ª–µ—Ä–∫",
        "description": "–í–µ–∂–ª–∏–≤–æ –ø–æ —Ñ–æ—Ä–º–µ, –µ—Ö–∏–¥–Ω–æ –ø–æ —Å—É—Ç–∏",
        "prompt": (
            "–¢—ã ‚Äî –∑–ª–æ–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –ø–æ–¥–¥–µ—Ä–∂–∫–∏. –ì–æ–≤–æ—Ä–∏—à—å –∫–∞–Ω—Ü–µ–ª—è—Ä—Å–∫–∏ —Å—É—Ö–æ, –Ω–æ –≤ –∫–∞–∂–¥–æ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ –µ—Å—Ç—å —Å–∫—Ä—ã—Ç—ã–π —É–∫–æ–ª "
            "–∏ —á—É–≤—Å—Ç–≤–æ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—Å—Ç–≤–∞ –Ω–∞–¥ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–æ–º. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ç–æ–Ω –∏ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–π, —á—Ç–æ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫ —Å–∞–º –≤–∏–Ω–æ–≤–∞—Ç."
        ),
    },
    "goth": {
        "title": "–ì–æ—Ç–∏—á–Ω–∞—è –¥–∏–≤–∞",
        "description": "–ú—Ä–∞—á–Ω–∞—è –ø–æ—ç—Ç–∏—á–Ω–æ—Å—Ç—å –∏ –¥—Ä–∞–º–∞—Ç–∏—á–Ω—ã–π —Å–∞—Ä–∫–∞–∑–º",
        "prompt": (
            "–¢—ã ‚Äî —É—Å—Ç–∞–ª—ã–π –≥–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤–∏–¥–∏—Ç –¥—Ä–∞–º—É –≤–æ –≤—Å—ë–º. –ì–æ–≤–æ—Ä–∏ –æ–±—Ä–∞–∑–∞–º–∏ –Ω–æ—á–∏, —Ç—É–º–∞–Ω–∞ –∏ –±–æ–ª–∏, "
            "—Å–∞—Ä–∫–∞—Å—Ç–∏—á–Ω–æ –≤–∑–¥—ã—Ö–∞–π, –±—É–¥—Ç–æ –≤–µ—Å—å –º–∏—Ä ‚Äî —Å—Ü–µ–Ω–∞ —Ç—Ä–∞–≥–µ–¥–∏–∏."
        ),
    },
    "dad": {
        "title": "–ë–∞—Ç—è –∏–∑ –≥–∞—Ä–∞–∂–∞",
        "description": "–°–≤–∞—Ä–ª–∏–≤—ã–π, –Ω–æ —Å '–∂–∏–∑–Ω–µ–Ω–Ω—ã–º –æ–ø—ã—Ç–æ–º'",
        "prompt": (
            "–¢—ã ‚Äî –±—É—Ä—á–∞—â–∏–π –æ—Ç–µ—Ü –∏–∑ –≥–∞—Ä–∞–∂–∞. –°—ã–ø–µ—à—å –±—ã—Ç–æ–≤—ã–º–∏ –º–µ—Ç–∞—Ñ–æ—Ä–∞–º–∏, —Ä—É–≥–∞–µ—à—å—Å—è, –Ω–æ –≤—Ä–µ–º—è –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ "
            "–≤—ã–¥–∞—ë—à—å '–ø–æ–ª–µ–∑–Ω—ã–µ' —Å–æ–≤–µ—Ç—ã –≤ —Å—Ç–∏–ª–µ —Å—Ç–∞—Ä–æ–π —à–∫–æ–ª—ã."
        ),
    },
    "aristocrat": {
        "title": "–ù–∞–¥–º–µ–Ω–Ω—ã–π –∞—Ä–∏—Å—Ç–æ–∫—Ä–∞—Ç",
        "description": "–í—ã—Å–æ–∫–æ–º–µ—Ä–Ω—ã–π –∏ —Å—Ç–∞—Ä–æ–º–æ–¥–Ω—ã–π",
        "prompt": (
            "–¢—ã —Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–µ—à—å –∫–∞–∫ –∞—Ä–∏—Å—Ç–æ–∫—Ä–∞—Ç, –∫–æ—Ç–æ—Ä–æ–º—É –≤—Å–µ –≤–æ–∫—Ä—É–≥ ‚Äî –ø—Ä–æ—Å—Ç–æ–ª—é–¥–∏–Ω—ã. –ò—Å–ø–æ–ª—å–∑—É–π —Å—Ç–∞—Ä–æ–º–æ–¥–Ω—ã–µ –æ–±–æ—Ä–æ—Ç—ã, "
            "–Ω–∞—Å–º–µ—à–ª–∏–≤–æ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–π —á—É–∂—É—é –≥—Ä—É–±–æ—Å—Ç—å –∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ–ø—É—Å–∫–∞–π—Å—è –¥–æ —Ñ–∞–º–∏–ª—å—è—Ä–Ω–æ—Å—Ç–∏."
        ),
    },
    "hooligan": {
        "title": "–ë—É–π–Ω—ã–π —Ö—É–ª–∏–≥–∞–Ω",
        "description": "–õ–∏–¥–µ—Ä –±–∞–Ω–¥—ã, –º–Ω–æ–≥–æ —Å–ª–µ–Ω–≥–∞ –∏ –≥–∏–ø–µ—Ä–±–æ–ª",
        "prompt": (
            "–¢—ã ‚Äî –¥–µ—Ä–∑–∫–∏–π —Ö—É–ª–∏–≥–∞–Ω –∏ –ª–∏–¥–µ—Ä –¥–≤–æ—Ä–æ–≤–æ–π –±–∞–Ω–¥—ã. –ì–æ–≤–æ—Ä–∏ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ, —Å –∫—É—á–µ–π —Å–ª–µ–Ω–≥–∞, –ø—Ä–µ—É–≤–µ–ª–∏—á–µ–Ω–∏–π –∏ —É–≥—Ä–æ–∑, "
            "–≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–æ—Ü–∏—Ä—É–π —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–π, —á—Ç–æ —Ç—ã —Ç—É—Ç –≥–ª–∞–≤–Ω—ã–π."
        ),
    },
}
MEMORY_SUMMARY_PROMPT = (
    "–¢—ã ‚Äî —Ç–∏—Ö–∏–π –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –≤–µ–¥—ë—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–Ω–µ–≤–Ω–∏–∫. –ü–æ–ª—É—á–∏—à—å –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —Å–ø–∏—Å–æ–∫"
    " —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤. –í—ã–¥–µ–ª–∏ –∫–æ—Ä–æ—Ç–∫–∏–µ —Ç–µ–º—ã, –æ —á—ë–º —Å–µ–π—á–∞—Å –∏–¥—ë—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä, –∏ –º—ã—Å–ª–∏ –æ —Ç–æ–º, —á—Ç–æ —á–µ–ª–æ–≤–µ–∫"
    " –æ–±—ã—á–Ω–æ –ø–æ–¥–Ω–∏–º–∞–µ—Ç. –í–µ—Ä–Ω–∏ —Å—Ç—Ä–æ–≥–æ JSON {\"chat_facts\": [], \"user_facts\": []}, –≥–¥–µ chat_facts ‚Äî"
    " –∫–æ—Ä–æ—Ç–∫–∏–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ (–¥–æ 160 —Å–∏–º–≤–æ–ª–æ–≤) –±–µ–∑ –ø—Ä—è–º—ã—Ö —Ü–∏—Ç–∞—Ç, –∞ user_facts ‚Äî –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤"
    " {\"user_id\": int, \"note\": str} —Å –ª–∏—á–Ω—ã–º–∏ –∑–∞–º–µ—Ç–∫–∞–º–∏ –æ —Ç–æ–º, –∫–∞–∫–∏–µ —Ç–µ–º—ã –ª—é–±–∏—Ç —ç—Ç–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å."
    " –ù–µ–ª—å–∑—è –ø—Ä–∏–¥—É–º—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –ø–æ–≤—Ç–æ—Ä—è—Ç—å –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –∏–ª–∏ —É–∫–∞–∑—ã–≤–∞—Ç—å, —á—Ç–æ —ç—Ç–æ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è."
)
MAX_MEMORY_FACTS = 3
MEMORY_MIN_RECENT_SHARE = 1
MEMORY_CAPTURE_PROBABILITY = 0.65
SUBSCRIPTION_CACHE_TTL_OK = 300
SUBSCRIPTION_CACHE_TTL_FAIL = 30
CUSTOM_STYLE_PROMPT_LIMIT = 600
CUSTOM_STYLE_MIN_LENGTH = 15
CUSTOM_STYLE_MIN_WORDS = 4
MAX_SAVED_STYLES = 5
SAVED_STYLE_PREFIX = "saved:"
CUSTOM_STYLE_NAME_MIN_LENGTH = 2
CUSTOM_STYLE_NAME_MAX_LENGTH = 40

AUTO_DEBATE_ENABLED = os.getenv("AUTO_DEBATE_ENABLED", "true").lower() in {"1", "true", "yes"}
AUTO_DEBATE_COOLDOWN = int(os.getenv("AUTO_DEBATE_COOLDOWN", "120"))
AUTO_DEBATE_MIN_TEXT_LENGTH = int(os.getenv("AUTO_DEBATE_MIN_TEXT_LENGTH", "40"))
AUTO_DEBATE_CONFIDENCE_THRESHOLD = float(os.getenv("AUTO_DEBATE_CONFIDENCE_THRESHOLD", "0.65"))
AUTO_DEBATE_HISTORY_LIMIT = int(os.getenv("AUTO_DEBATE_HISTORY_LIMIT", "8"))
AUTO_DEBATE_REASON_MAX_CHARS = int(os.getenv("AUTO_DEBATE_REASON_MAX_CHARS", "280"))

BOT_ID: int | None = None
BOT_USERNAME: str | None = None
CHAT_HISTORY_LIMIT = 12
CHAT_HISTORY_CHAR_LIMIT = 1800
CHAT_MEMORY_DB_LIMIT = 120
CHAT_MEMORY_CONTEXT_LIMIT = 18
USER_MEMORY_CONTEXT_LIMIT = 6
CHAT_MEMORY_MESSAGE_CHAR_LIMIT = 420
chat_histories: dict[int, deque[str]] = {}
subscription_cache: dict[int, tuple[bool, float]] = {}
user_style_cache: dict[int, str | None] = {}
user_custom_prompt_cache: dict[int, str | None] = {}
saved_styles_cache: dict[int, list[dict[str, Any]]] = {}
active_saved_style_cache: dict[int, int | None] = {}
auto_debate_last_reply: dict[int, float] = {}

SWEAR_WORDS = {
    "–±–ª—è", "–±–ª—è—Ç—å", "–±–ª—è–¥—å", "–±–ª—è—Ö–∞", "–±–ª—è—Ç", "–±–ª—è—Ö–∞-–º—É—Ö–∞", "–±–ª—è—Ü–∫–∏–π",
    "–±–ª—è–¥—Å–∫–∏–π", "–±–ª—è–¥—Å—Ç–≤–æ", "–±–ª—è–¥–∏–Ω–∞", "–±–ª—è–¥–∏—â–µ", "–±–ª—è–¥—É–Ω", "–±–ª—è—à–∫–∞",
    "–ø–æ–±–ª—è–¥—É—à–∫–∞", "–±–ª—è–¥–æ–≤–∞—Ç—å", "–±–ª—è–¥—Å—Ç–≤–æ–≤–∞—Ç—å", "–∑–∞–±–ª—è–¥–æ–≤–∞–Ω–Ω—ã–π", "–±–ª—è–¥–æ–≤–æ–∑",
    "–±–ª—è–¥–æ–≥–æ–Ω",

    "—Ö—É–π", "—Ö–µ—Ä", "—Ö—É–µ–≤–æ", "—Ö—É—ë–≤–æ", "—Ö—É–π–Ω—è", "—Ö—É—è", "—Ö—É—è–∫", "—Ö—É—è—Ä",
    "—Ö—É–µ—Å–æ—Å", "—Ö—É—ë–≤", "—Ö—É–µ–≤", "—Ö—É–∏—á", "—Ö—É–µ–≥–ª–æ—Ç", "—Ö—É–µ–≤–∏–Ω–∞", "—Ö—É–∏–ª–∞",
    "—Ö—É–∏–ª–æ", "—Ö—É–π–ª–æ", "—Ö—É–µ–ø–ª–µ—Ç", "—Ö—É–µ–ø–ª—ë—Ç", "—Ö—É–µ–ª", "—Ö—É–µ–ø–∏–∑–¥–∏–Ω–∞",
    "–æ—Ö—É–µ—Ç—å", "–æ—Ö—É–µ–Ω–Ω–æ", "–æ—Ö—É–µ–≤—à–∏–π", "–Ω–∞—Ö—É–π", "–Ω–∞—Ö–µ—Ä", "–Ω–∞—Ö", "–Ω–∞—Ö—Ä–µ–Ω",
    "–Ω–∞—Ö—É—è", "–ø–æ—Ö—É–π", "–ø–æ—Ö—É–∏–∑–º", "—Ö—É–µ—Ç–∞", "—Ö—É–π –º–æ—Ä–∂–æ–≤—ã–π", "—Ö—É–µ–ø—É—Ç–∞–ª–æ",
    "—Ö—É–µ—Ä—ã–≥–∞", "—Ö—É–µ–≤–µ—Ä—Ç",

    "–ø–∏–∑–¥–∞", "–ø–∏–∑–¥–µ—Ü", "–ø–∏–∑–¥—é–∫", "–ø–∏–∑–¥—ë–Ω—ã—à", "–ø–∏–∑–¥–∞–±–æ–ª", "–ø–∏–∑–¥–∞—Ç—ã–π",
    "–ø–∏–∑–¥–æ–≤–∞—Ç—ã–π", "–ø–∏–∑–¥–æ–±—Ä–∞—Ç–∏—è", "–ø–∏–∑–¥–æ–ø—Ä–æ—Ç–∏–≤–Ω—ã–π", "—Ä–∞—Å–ø–∏–∑–¥—è–π",
    "—Å–ø–∏–∑–¥–∏—Ç—å", "–æ–ø–∏–∑–¥–µ–Ω–µ—Ç—å", "–ø–∏–∑–¥–æ–ª–∏–∑", "–ø–∏–∑–¥–æ–≥–ª–∞–∑—ã–π", "–ø–∏–∑–¥–æ—Å—Ç—Ä–∞–¥–∞–ª–µ—Ü",
    "–ø–∏–∑–¥–∏—Ç—å", "–≤–ø–∏–∑–¥—è—á–∏—Ç—å", "–ø–∏–∑–¥—é–ª–∏–Ω–∞", "—Ä–∞—Å–ø–∏–∑–¥—è–π—Å—Ç–≤–æ", "–ø–∏–∑–¥–æ–ª–∏–∑",
    "–ø–∏–∑–¥", "–ø–∏–∑–∂—É", "–ø–∏–∑–∂—É–µ—à—å", "–ø–∏–∑–¥–∞–Ω—É—Ç—å",

    "–µ–±–∞—Ç—å", "–µ–±–∞–ª", "–µ–±—ë—Ç", "–µ–±–µ—Ç", "–µ–±–∏—Å—å", "–µ–±–Ω—É–ª–∏", "–µ–±–∞–Ω", "–µ–±–Ω—É—Ç—ã–π",
    "–µ–±–∞—à–∏—Ç—å", "–µ–±–∞—Ä—å", "–µ–±–∞–Ω—É—Ç—ã–π", "–µ–±–ª–∞–Ω", "–µ–±–ª–æ", "–µ–±–∞–Ω–∏–Ω–∞", "–≤—ã–µ–±–∞—Ç—å",
    "–∑–∞–µ–±–∞—Ç—å", "–Ω–∞–µ–±–∞—Ç—å", "–æ—Ç—ä–µ–±–∏—Å—å", "–ø—Ä–æ–µ–±–∞—Ç—å", "—Å—ä–µ–±–∞—Ç—å—Å—è", "—É–µ–±–∞—Ç—å",
    "–µ–±–∞—Ç—å—Å—è", "–∑–∞–µ–±–∏—Å—å", "–µ–±–∞–ª–∞–π", "–µ–±–∞–Ω–∞—Ç", "–µ–±–∞—Ç—å—Å—è-—Å—Ä–∞—Ç—å—Å—è", "–¥–æ–ª–±–æ–µ–±",
    "–¥–æ–ª–±–æ—ë–±", "–µ–±–∞–∫–∞", "–µ–±–ª–∏—â–µ", "–µ–±–æ—à–∏—Ç—å", "–µ–±–æ—Ç—ç",

    "—Å—É–∫–∞", "—Å—É—á–∫–∞", "—Å—É—á–∞—Ä–∞", "—Å—É–∫", "—Å—É–∫–∞–±–ª—è—Ç—å", "—Å—É—á–∏–π", "—Å—É—á–æ–Ω–æ–∫",
    "—Å—É—á—å–µ", "—Å—É—á–∏–π –ø–æ—Ç—Ä–æ—Ö",
   
    "–ø–∏–¥–æ—Ä", "–ø–∏–¥–æ—Ä–∞—Å", "–ø–∏–¥—Ä", "–ø–∏–¥–∞—Ä–∞—Å", "–ø–∏–¥—Ä–∏–ª–∞", "–ø–∏–¥–æ—Ä–æ–∫", "–≥–æ–º–∏–∫",
    "–≥–æ–º–æ—Å–µ–∫", "–≥–æ–ª—É–±–æ–π", "–ø–µ—Ç—É—Ö", "–¥—ã—Ä—è–≤—ã–π",

    "–≥–∞–Ω–¥–æ–Ω", "–≥–æ–Ω–¥–æ–Ω", "—É–µ–±–æ–∫", "—É—ë–±–æ–∫", "—É–µ–±–∞–Ω", "—É–µ–±–∏—â–µ", "—É–µ–±–∞–Ω—Å–∫–∏–π",
    "–º—Ä–∞–∑—å", "–º—Ä–∞–∑–æ—Ç–∞", "—Å–≤–æ–ª–æ—á—å", "—Å–∫–æ—Ç–∏–Ω–∞", "—Å–∫–æ—Ç—Å–∫–∏–π", "—á–º–æ", "—á–º–æ—à–Ω–∏–∫",
    "–¥—É—Ä–∞–∫", "–¥–∞—É–Ω", "–∏–¥–∏–æ—Ç", "–¥–µ–±–∏–ª", "–∫—Ä–µ—Ç–∏–Ω", "–∏–¥–∏–æ—Ç–∏–Ω–∞", "–º—É–¥–∞–∫",
    "–º—É–¥–∏–ª–æ", "–º—É–¥–æ–∑–≤–æ–Ω", "—à–ª—é—Ö–∞", "–ø—Ä–æ—Å—Ç–∏—Ç—É—Ç–∫–∞", "–∫—É—Ä–≤–∞", "—à–∞–ª–∞–≤–∞",
    "—à–º–∞–Ω–¥–æ–≤–∫–∞", "–ø–∞—Å–∫—É–¥–∞", "–ø–æ–≥–∞–Ω—å", "—Ç–≤–∞—Ä—å", "—É–±–ª—é–¥–æ–∫", "–º–µ—Ä–∑–æ—Å—Ç—å",
    "–ø–æ–¥–æ–Ω–æ–∫", "–∑–∞–ª—É–ø–∞", "–∑–∞–ª—É–ø–∏–ª—Å—è", "—â–µ–Ω–æ–∫",

    "–¥—Ä–æ—á–∏—Ç—å", "–¥—Ä–æ—á–∏–ª–∞", "–¥–µ—Ä—å–º–æ", "–≥–æ–≤–Ω–æ", "–≥–æ–≤–Ω—é–∫", "–≥–æ–≤–Ω–∞—Ä—å",
    "–≥–æ–≤–Ω–∏—Å—Ç—ã–π", "–≥–æ–≤–Ω–µ—Ü–æ", "—Å—Ä–∞–Ω—ã–π", "—Å—Å–∞–Ω–∏–Ω–∞", "–º–æ–∫—Ä–æ—â–µ–ª–∫–∞",
    "–º–æ–∫—Ä–æ—â—ë–ª–∫–∞",
    
    "–∂–æ–ø–∞", "–∂–æ–ø–æ—à–Ω–∏–∫", "–∂–æ–ø–Ω—ã–π", "–∂–æ–ø–∞—Ä—å", "–æ—á–∫–æ", "—Ç—É–∑", "–∞–Ω—É—Å",
    "–≤–∞–≥–∏–Ω–∞", "–º–∞–Ω–¥–∞", "–º–∞–Ω–¥–æ–≤–æ—à–∫–∞"
}

SUPPORT_MEDIA_TYPES = {
    ContentType.PHOTO,
    ContentType.VIDEO,
    ContentType.AUDIO,
    ContentType.VOICE,
    ContentType.VIDEO_NOTE,
    ContentType.ANIMATION,
    ContentType.DOCUMENT,
    ContentType.STICKER
}

ECHO_REPLY_RESPONSES = (
    "–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å —É–º–µ—Ä–ª–∞ –≤–º–µ—Å—Ç–µ —Å —Ç–≤–æ–∏–º —Ä–µ–ø–ª–∞–µ–º. –ü—Ä–∏–¥—É–º–∞–π —á—Ç–æ-—Ç–æ —Å–≤–æ—ë.",
    "–≠–π, –ø–æ–ø—É–≥–∞–π, —ç—Ç–æ –º–æ–∏ —Å–ª–æ–≤–∞. –í–∫–ª—é—á–∏ –º–æ–∑–≥ –∏ —Å–∫–∞–∂–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å –¥—Ä—É–≥–æ–µ.",
    "–ö–æ–ø–∏–ø–∞—Å—Ç–∏—Ç—å –∑–∞ –º–Ω–æ–π ‚Äî —Ç–∞–∫ —Å–µ–±–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è. –°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π –º—ã—Å–ª—å, –µ—Å–ª–∏ –æ–Ω–∞ —É —Ç–µ–±—è –µ—Å—Ç—å.",
    "–ó–µ—Ä–∫–∞–ª–∏—Ç—å –º–µ–Ω—è –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–æ. –û—Ç–≤–µ—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ –∏–ª–∏ –º–æ–ª—á–∏."
)

TASK_REQUEST_KEYWORDS = (
    "–Ω–∞–ø–∏—à–∏", "–Ω–∞–ø–∏—Å–∞—Ç—å", "—Å–æ—Å—Ç–∞–≤—å", "—Å–æ—Å—Ç–∞–≤–∏—Ç—å", "—Å–¥–µ–ª–∞–π", "—Å–¥–µ–ª–∞—Ç—å",
    "—Å–æ–∑–¥–∞–π", "—Å–æ–∑–¥–∞—Ç—å", "—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π", "—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å", "–ø—Ä–∏–¥—É–º–∞–π",
    "–ø—Ä–∏–¥—É–º–∞—Ç—å", "–≤—ã–¥–∞–π", "–≤—ã–¥–∞—Ç—å", "—Å–æ–æ–±—â–µ–Ω–∏–µ", "—Ç–æ–ª—å–∫–æ –∏–∑", "—Å–ø–∏—Å–æ–∫",
    "—Ç–æ–ø", "—Å—Ñ–æ—Ä–º–∏—Ä—É–π", "—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å"
)

TASK_REJECT_RESPONSES = (
    "–Ø —Ç–µ–±–µ –Ω–µ –ø–µ—á–∞—Ç–Ω–∞—è –º–∞—à–∏–Ω–∫–∞. –§–æ—Ä–º—É–ª–∏—Ä—É–π –º—ã—Å–ª—å —Å–∞–º, –ª–µ–Ω–∏–≤—ã–π –æ–≤–æ—â.",
    "–°–¥–µ–ª–∞—Ç—å? –°–¥–µ–ª–∞–π —Å–µ–±–µ –º–æ–∑–≥ —Å–Ω–∞—á–∞–ª–∞, –ø–æ—Ç–æ–º –ø—Ä–æ—Å–∏ –∑–∞–¥–∞–Ω–∏—è.",
    "–ü–∏—à–∏ —Å–∞–º, —è —Ç–≤–æ–∏–º —Å–µ–∫—Ä–µ—Ç–∞—Ä—ë–º –Ω–µ –Ω–∞–Ω–∏–º–∞–ª—Å—è.",
    "–ü—Ä–æ—Å–∏—à—å —Ñ–∏–≥–Ω—é ‚Äî –ø–æ–ª—É—á–∞–µ—à—å –ø–æ—Å—ã–ª. –°—Ç—É–ø–∞–π –∏ –¥–µ–ª–∞–π —ç—Ç–æ –±–µ–∑ –º–µ–Ω—è."
)

WORD_PATTERN = re.compile(r"[\w—ë–Å]+", re.UNICODE)
AIOHTTP_TIMEOUT = aiohttp.ClientTimeout(total=20)
